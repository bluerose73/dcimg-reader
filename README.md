# DCIMG Reader

DCIMG reader for MATLAB and Fiji.

DCIMG is an image format produced by Hamamatsu cameras. It is designed for high-speed data storage.

## MATLAB MEX Functions

Download ``DCIMG-MEX-Windows-x64.zip`` from releases.

Decompress and add all files (``dcimg_get_size.mexw64``, ``dcimg_read_frame.mexw64``, and ``dcimgapi.dll``) to MATLAB path.

Example Usage

```MATLAB
[height, width, n_frames] = dcimg_get_size('filename.dcimg')

image = dcimg_read_frame('filename.dcimg', 1)  % read the 1st frame (1-indexed)
image = dcimg_read_frame_range('filename.dcimg', 1, 100)  % read frame 100 frames starting from frame 1
```

## Fiji Plugin

Download ``DCIMG-Fiji-Plugin-Windows-x64.zip`` from releases.

Decompress and put the "DCIMG" folder into Fiji/ImageJ2's ``plugins`` folder.

Then, you can open ``.dcimg`` files by ``File -> Open`` or drag-and-drop.

## Build

DCIMG Reader only supports 64-bit Windows platform.

### Building MATLAB MEX Functions

To build the mex files from source, you need these dependencies installed:
- CMake
- At least one C++ build tools. For example,
  - Visual Studio
  - MinGW

Run the following lines in the top-level directory of this repository.

```bash
mkdir build
cd build
cmake ..
cmake --build . --config Release
```

### Building Fiji Plugin

Dependencies:
- Maven
- JDK

In addition to the steps in "Building MATLAB MEX Functions", run

```bash
cd fiji_plugin
mvn
```

The resulting JAR file locates in ``target`` folder.
You also need the DLL files ``dcimg_jni.dll`` and ``dcimgapi.dll`` generated by CMake.